#include <iostream>
#include <vector>
#include <string>

// Функция для вычисления префикс-функции строки
// Префикс-функция π[i] - длина наибольшего собственного суффикса подстроки s[0..i], 
// который одновременно является префиксом всей строки
std::vector<int> prefix_function(const std::string& s) {
    int n = s.size(); // Длина строки
    std::vector<int> pi(n, 0); // Создаем массив для хранения значений префикс-функции, инициализируем нулями

    // Проходим по каждому символу строки, начиная со второго (индекс 1)
    for (int i = 1; i < n; ++i) {
        int j = pi[i - 1]; // Берем значение префикс-функции для предыдущего символа

        // Пока j > 0 и символы не совпадают, двигаемся назад по цепочке префиксов
        while (j > 0 && s[j] != s[i]) {
            j = pi[j - 1]; // Переходим к следующему возможному префиксу
        }

        // Проверяем, совпадают ли символы
        if (s[j] == s[i]) {
            ++j; // Если совпали, увеличиваем длину совпадающего префикса-суффикса
        }

        pi[i] = j; // Записываем вычисленное значение префикс-функции для текущей позиции
    }

    // Возвращаем вычисленную префикс-функцию
    return pi;
}

int main() {
    // Пример использования:
    std::string s = "xyzxyzx";
    std::vector<int> result = prefix_function(s);
    
    std::cout << "Префикс-функция:";
    for (int value : result) {
        std::cout << " " << value;
    }
    std::cout << std::endl;

    return 0;
}